<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Giardino Digitale</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
    <link rel="manifest" href="/manifest.json">
    <meta name="theme-color" content="#4CAF50">
</head>
<body>
    <div id="loadingSpinner" class="spinner-overlay">
        <div class="spinner"></div>
    </div>

    <header>
        <h1>Giardino Digitale</h1>
        <div class="auth-buttons">
            <button id="loginButton" class="btn">Login</button>
            <button id="registerButton" class="btn">Registrati</button>
            <button id="logoutButton" class="btn hidden">Logout</button>
        </div>
    </header>

    <main>
        <section id="authSection" class="auth-section">
            <div class="auth-container">
                <h2>Login</h2>
                <input type="email" id="loginEmail" placeholder="Email">
                <input type="password" id="loginPassword" placeholder="Password">
                <button id="signInBtn" class="btn">Accedi</button>
                <p>Non hai un account? <a href="#" id="showRegister">Registrati qui</a></p>
                <div id="loginError" class="error-message hidden"></div>
            </div>

            <div class="auth-container hidden" id="registerContainer">
                <h2>Registrazione</h2>
                <input type="email" id="registerEmail" placeholder="Email">
                <input type="password" id="registerPassword" placeholder="Password">
                <input type="password" id="confirmPassword" placeholder="Conferma Password">
                <button id="signUpBtn" class="btn">Registrati</button>
                <p>Hai già un account? <a href="#" id="showLogin">Accedi qui</a></p>
                <div id="registerError" class="error-message hidden"></div>
            </div>
        </section>

        <section id="appSection" class="app-section hidden">
            <div class="controls">
                <input type="text" id="searchInput" placeholder="Cerca piante...">
                <select id="categoryFilter">
                    <option value="">Tutte le Categorie</option>
                    <option value="Fiore">Fiore</option>
                    <option value="Frutto">Frutto</option>
                    <option value="Verdura">Verdura</option>
                    <option value="Erba">Erba</option>
                    <option value="Altro">Altro</option>
                </select>
                <select id="sortOrder">
                    <option value="nameAsc">Nome (A-Z)</option>
                    <option value="nameDesc">Nome (Z-A)</option>
                </select>
            </div>

            <div class="tabs">
                <button id="myGardenTab" class="tab-button active">Mio Giardino</button>
                <button id="allPlantsTab" class="tab-button">Tutte le Piante</button>
            </div>

            <div class="action-buttons">
                <button id="addPlantBtn" class="btn add-plant-btn"><i class="fas fa-plus"></i> Aggiungi Pianta</button>
                <button id="googleLensBtn" class="btn google-lens-btn"><i class="fas fa-camera"></i> Google Lens</button>
                <button id="getWeatherBtn" class="btn weather-btn"><i class="fas fa-cloud-sun"></i> Ottieni Clima</button>
            </div>

            <div id="weatherInfo" class="weather-info hidden">
                <h3>Clima Attuale a <span id="weatherCity"></span></h3>
                <p>Temperatura: <span id="weatherTemp"></span>°C</p>
                <p>Condizioni: <span id="weatherConditions"></span></p>
                <p>Umidità: <span id="weatherHumidity"></span>%</p>
            </div>

            <div id="plantList" class="plant-grid">
                </div>
        </section>
    </main>

    <div id="plantDetailModal" class="modal">
        <div class="modal-content detail-modal-content">
            <span class="close-button">&times;</span>
            <h2 id="detailPlantName"></h2>
            <img id="detailPlantImage" src="" alt="Immagine Pianta" class="modal-image">
            <p><strong>Descrizione:</strong> <span id="detailPlantDescription"></span></p>
            <p><strong>Esposizione al Sole:</strong> <span id="detailPlantSunlight"></span></p>
            <p><strong>Frequenza Innaffiatura:</strong> <span id="detailPlantWatering"></span></p>
            <p><strong>Categoria:</strong> <span id="detailPlantCategory"></span></p>
            <p><strong>Lux Ideali:</strong> Min <span id="detailIdealLuxMin"></span> - Max <span id="detailIdealLuxMax"></span></p>
            <p><strong>Temperatura Ideale:</strong> Min <span id="detailTempMin"></span>°C - Max <span id="detailTempMax"></span>°C</p>
            <p><strong>Data Aggiunta:</strong> <span id="detailDateAdded"></span></p>
            <div class="detail-actions">
                <button id="editPlantBtn" class="btn edit-btn">Modifica</button>
                <button id="deletePlantBtn" class="btn delete-btn">Elimina</button>
                <button id="addToGardenBtn" class="btn add-to-garden-btn">Aggiungi al Mio Giardino</button>
                <button id="removeFromGardenBtn" class="btn remove-from-garden-btn hidden">Rimuovi dal Mio Giardino</button>
            </div>
        </div>
    </div>

    <div id="plantModal" class="modal">
        <div class="modal-content">
            <span class="close-button">&times;</span>
            <h2 id="plantModalTitle">Aggiungi Nuova Pianta</h2>
            <form id="plantForm">
                <input type="hidden" id="plantId">
                <label for="plantFormPlantName">Nome Pianta:</label>
                <input type="text" id="plantFormPlantName" placeholder="Nome della Pianta" required>
                <div id="plantFormPlantNameError" class="error-message hidden"></div>

                <label for="plantFormPlantDescription">Descrizione:</label>
                <textarea id="plantFormPlantDescription" placeholder="Breve descrizione della pianta"></textarea>

                <label for="plantFormPlantSunlight">Esposizione al Sole:</label>
                <select id="plantFormPlantSunlight" required>
                    <option value="">Seleziona...</option>
                    <option value="Pieno Sole">Pieno Sole</option>
                    <option value="Mezz'ombra">Mezz'ombra</option>
                    <option value="Ombra">Ombra</option>
                </select>
                <div id="plantFormPlantSunlightError" class="error-message hidden"></div>

                <label for="plantFormPlantWatering">Frequenza Innaffiatura:</label>
                <select id="plantFormPlantWatering" required>
                    <option value="">Seleziona...</option>
                    <option value="Bassa">Bassa</option>
                    <option value="Moderata">Moderata</option>
                    <option value="Alta">Alta</option>
                </select>
                <div id="plantFormPlantWateringError" class="error-message hidden"></div>

                <label for="plantFormPlantCategory">Categoria:</label>
                <select id="plantFormPlantCategory" required>
                    <option value="">Seleziona...</option>
                    <option value="Fiore">Fiore</option>
                    <option value="Frutto">Frutto</option>
                    <option value="Verdura">Verdura</option>
                    <option value="Erba">Erba</option>
                    <option value="Altro">Altro</option>
                </select>
                <div id="plantFormPlantCategoryError" class="error-message hidden"></div>

                <label for="plantFormIdealLuxMin">Lux Ideali Min:</label>
                <input type="number" id="plantFormIdealLuxMin" placeholder="Es. 1000">
                <div id="plantFormIdealLuxMinError" class="error-message hidden"></div>

                <label for="plantFormIdealLuxMax">Lux Ideali Max:</label>
                <input type="number" id="plantFormIdealLuxMax" placeholder="Es. 5000">
                <div id="plantFormIdealLuxMaxError" class="error-message hidden"></div>

                <label for="plantFormTempMin">Temperatura Ideale Min (°C):</label>
                <input type="number" id="plantFormTempMin" placeholder="Es. 15">
                <div id="plantFormTempMinError" class="error-message hidden"></div>

                <label for="plantFormTempMax">Temperatura Ideale Max (°C):</label>
                <input type="number" id="plantFormTempMax" placeholder="Es. 25">
                <div id="plantFormTempMaxError" class="error-message hidden"></div>

                <label for="plantImageUpload">Carica Immagine:</label>
                <input type="file" id="plantImageUpload" accept="image/*">
                <div id="plantImageUploadError" class="error-message hidden"></div>
                <img id="currentPlantImage" src="" alt="Immagine corrente" class="hidden current-image-preview">

                <button type="submit" id="savePlantBtn" class="btn">Salva Pianta</button>
            </form>
        </div>
    </div>

    <div id="imageZoomModal" class="modal">
        <div class="modal-content image-zoom-content">
            <span class="close-button">&times;</span>
            <img id="zoomedImage" src="" alt="Immagine Ingrandita">
        </div>
    </div>

    <div id="toast" class="toast"></div>

    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-auth-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-firestore-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.6.1/firebase-storage-compat.js"></script>
    <script src="app.js"></script>
</body>
</html>
